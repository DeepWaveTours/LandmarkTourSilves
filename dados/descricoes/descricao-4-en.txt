The Castle of Lagos, officially known as the Walls and Turrets of Lagos and the Urban Enclosure and Fortified Front of Lagos, is a military monument in the city of Lagos, in the Algarve region of Portugal. Although the set of defensive structures of the city is known as the Castle of Lagos, this designation mainly applies to the fortress known as the Castle of the Governors, while the remaining perimeter, composed of several sections of walls and bastions, is known as the Walls of Lagos.
Wikipedia

The area where the modern city of Lagos is located, on the right bank of the Bensafrim River, may have been founded by the Carthaginians in the mid-first millennium BC. This settlement probably had some defensive structures, but the first fortification comparable to a castle was only built during the Islamic period, likely being an alcazaba, which may have been the origin of the later Castle of the Governors. After the Reconquista, the construction of a set of walls around the city began, which at that time would only be the area between the São Gonçalo Gate, the Porta da Vila, the castle, and the future Church of Santo António. The works began during the reign of King Afonso III (1248–1279) and were probably completed in the 14th century.
Wikipedia

Due to the progressive urban expansion of the city of Lagos and its importance as part of the Portuguese Discoveries, in the early 16th century, the construction of a second line of walls began to be considered, which was completed during the reign of King João III (1502–1557). This construction program also included the castle itself, which was expanded, and in that century began to be used as a residence for the governors, hence becoming popularly known as the Castle of the Governors. The city and its defenses entered a phase of decline after the Restoration of Independence in 1640, and in 1755 it was devastated by an earthquake that destroyed the castle and most of the walls. The castle was never rebuilt, eventually being partially converted into a hospital. The set of walls and the castle were elevated to National Monument status in 1924, and in the 1950s, the Estado Novo regime carried out extensive restoration works as part of the centenary celebrations of Prince Henry the Navigator. Since then, the walls and the castle have undergone several conservation interventions, notably the works carried out in the 1980s by the Directorate-General for Buildings and National Monuments, and in the 2010s by the Lagos City Council.